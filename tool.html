<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë²•ë¥ ì‚¬ë¬´ì†Œ - ë¹„ì ë¶„ì„ ì‹œìŠ¤í…œ v1.7</title>
    <style>
        :root { --primary: #2c3e50; --accent: #3498db; }
        body { font-family: 'Malgun Gothic', sans-serif; background: #f0f2f5; padding: 20px; display: flex; justify-content: center; }
        .app-container { width: 100%; max-width: 500px; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); overflow: hidden; }
        .header { background: var(--primary); color: white; padding: 25px; text-align: center; }
        .content { padding: 30px; }
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #34495e; font-size: 0.85rem; }
        input, select { width: 100%; padding: 12px; border: 1.5px solid #dce4ec; border-radius: 8px; box-sizing: border-box; font-size: 1rem; }
        .api-section { background: #fff9db; padding: 15px; border-radius: 8px; margin-bottom: 25px; border: 1px solid #fab005; }
        button { width: 100%; padding: 16px; background: var(--accent); color: white; border: none; border-radius: 8px; font-size: 1.1rem; font-weight: bold; cursor: pointer; }
        #result-box { margin-top: 25px; display: none; border-top: 2px solid #eee; padding-top: 20px; }
        #analysis-output { background: #f8f9fa; padding: 20px; border-radius: 10px; line-height: 1.8; font-size: 1rem; color: #2c3e50; border-left: 5px solid var(--accent); white-space: pre-wrap; }
        .loading { text-align: center; display: none; color: var(--accent); font-weight: bold; padding: 20px; }
    </style>
</head>
<body>

<div class="app-container">
    <div class="header"><h1>IMMIGRATION ANALYZER</h1></div>
    <div class="content">
        <div class="api-section">
            <label>ì‹œìŠ¤í…œ ì¸ì¦í‚¤ (API KEY)</label>
            <input type="password" id="apiKey" placeholder="ì¸ì¦í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
        </div>
        <div class="input-group"><label>í˜„ì¬ ë¹„ì</label><input type="text" id="visaType" value="E-9"></div>
        <div class="input-group"><label>ì‹ ì²­ì¸ ì—°ë ¹</label><input type="number" id="age" value="30"></div>
        <div class="input-group"><label>ì—°ê°„ ì†Œë“(ë§Œì›)</label><input type="number" id="income" value="3000"></div>
        <div class="input-group">
            <label>í•œêµ­ì–´ ëŠ¥ë ¥</label>
            <select id="lang">
                <option value="3ê¸‰">3ê¸‰ (ì‚¬íšŒí†µí•© 3ë‹¨ê³„)</option>
                <option value="4ê¸‰">4ê¸‰ (ì‚¬íšŒí†µí•© 4ë‹¨ê³„)</option>
                <option value="2ê¸‰">2ê¸‰ (ì‚¬íšŒí†µí•© 2ë‹¨ê³„)</option>
                <option value="5ê¸‰ ì´ìƒ">5ê¸‰ ì´ìƒ</option>
            </select>
        </div>
        <button onclick="startAnalysis()">ì‹¤ì‹œê°„ ë¶„ì„ ì‹¤í–‰</button>
        <div id="loading" class="loading">ì¤‘ì•™ ì„œë²„ ë°ì´í„° ëŒ€ì¡° ì¤‘...</div>
        <div id="result-box">
            <div style="font-weight:bold; margin-bottom:15px;">ğŸ” ë¶„ì„ ê²°ê³¼ ë¦¬í¬íŠ¸</div>
            <div id="analysis-output"></div>
        </div>
    </div>
</div>

<script>
async function startAnalysis() {
    const key = document.getElementById('apiKey').value.trim();
    if(!key) { alert('ì¸ì¦í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }

    const loading = document.getElementById('loading');
    const resultBox = document.getElementById('result-box');
    const output = document.getElementById('analysis-output');

    loading.style.display = 'block';
    resultBox.style.display = 'none';

    const promptText = `ë„ˆëŠ” ì¶œì…êµ­ ì „ë¬¸ ì‚¬ë¬´ì¥ì˜ ë¹„ì„œì•¼. ì•„ë˜ ì •ë³´ë¡œ K-point 700ê³¼ F-2-R ê°€ëŠ¥ì„±ì„ ë¶„ì„í•´ì¤˜.
    [ë°ì´í„°] ë¹„ì: ${document.getElementById('visaType').value}, ë‚˜ì´: ${document.getElementById('age').value}, ì—°ë´‰: ${document.getElementById('income').value}ë§Œì›, í•œêµ­ì–´: ${document.getElementById('lang').value}`;

    try {
        // [ê¸´ê¸‰ ìˆ˜ì •] v1betaì™€ gemini-1.5-flashë¥¼ ê°€ì¥ ì›ì‹œì ì¸(Raw) ê²½ë¡œë¡œ ì¡°í•©
        // URL í˜•ì‹ì„ êµ¬ê¸€ ê³µì‹ API Explorerì™€ ë™ì¼í•˜ê²Œ ë§ì¶¤
        const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${key}`;
        
        const response = await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                contents: [{ parts: [{ text: promptText }] }]
            })
        });

        const resData = await response.json();

        // ë§Œì•½ v1betaì—ì„œ ì‹¤íŒ¨í•  ê²½ìš°ë¥¼ ëŒ€ë¹„í•œ 2ì°¨ ì‹œë„ ë¡œì§ (v1)
        if (resData.error && resData.error.status === "NOT_FOUND") {
             throw new Error("ì„œë²„ ê²½ë¡œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (NOT_FOUND)");
        }

        const text = resData.candidates[0].content.parts[0].text;
        loading.style.display = 'none';
        resultBox.style.display = 'block';
        output.innerText = text;

    } catch (error) {
        loading.style.display = 'none';
        // ìµœì¢… ìˆ˜ë‹¨: ì‚¬ìš©ìì—ê²Œ ë” êµ¬ì²´ì ì¸ ì•ˆë‚´ë¥¼ í•¨
        alert('ë¶„ì„ ì˜¤ë¥˜: ' + error.message + '\n\në§Œì•½ NOT_FOUNDê°€ ê³„ì†ëœë‹¤ë©´, êµ¬ê¸€ API í‚¤ ìƒì„± ì‹œ ëª¨ë¸ ì„ íƒì´ ì˜ëª»ë˜ì—ˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
    }
}
</script>
</body>
</html>